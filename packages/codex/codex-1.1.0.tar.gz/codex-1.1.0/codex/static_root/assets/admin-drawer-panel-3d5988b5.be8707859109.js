import{m as T,a as I,u as _,b as k,_ as h,o as s,c,d as p,V as L,e as m,f as a,w as t,g as y,h as B,i as f,j as o,t as d,F as C,r as V,k as b,l as $,n as g,p as S,q as O,s as P,v as w,x as F,y as M,z as N,A as j,B as x,C as z,D,E}from"./admin-92aa290d.js";const U={name:"AdminStatusList",data(){return{mdiCloseCircleOutline:T}},computed:{...I(_,{librarianStatuses:e=>e.librarianStatuses,show:e=>e.librarianStatuses.length>0})},created(){this.load()},methods:{...k(_,["loadTable","librarianTask"]),indeterminate:e=>!e.preactive&&+e.total==0,progress(e){return e.preactive||+e.total==0?0:100*+e.complete/+e.total},load(){this.loadTable("LibrarianStatus")},clear(){this.librarianTask("librarian_clear_status","")}}},q=e=>(O("data-v-89ffc8fa"),e=e(),P(),e),G={key:0},R=q(()=>b("h4",null,"Librarian Tasks",-1)),W={nav:"",class:"statusItem"},H={class:"statusItemTitle"},J={key:0};function K(e,r,i,v,u,l){return s(),c(C,null,[e.show?(s(),p(L,{key:0})):m("",!0),a(S,{onClick:l.load},{default:t(()=>[a(y,null,{default:t(()=>[e.show?(s(),c("div",G,[a(B,{id:"clearButton",size:"small",icon:"",title:"Clear Librarian Statuses",onClick:l.clear},{default:t(()=>[a(f,null,{default:t(()=>[o(d(u.mdiCloseCircleOutline),1)]),_:1})]),_:1},8,["onClick"]),R,(s(!0),c(C,null,V(e.librarianStatuses,n=>(s(),p(y,{key:`${n.type} ${n.name}`},{default:t(()=>[b("div",W,[b("div",H,[o(d(n.type)+" "+d(n.name)+" ",1),+n.total?(s(),c("span",J,d(n.complete)+"/"+d(n.total),1)):m("",!0)]),a($,{indeterminate:l.indeterminate(n),"model-value":l.progress(n),bottom:""},null,8,["indeterminate","model-value"])])]),_:2},1024))),128))])):(s(),p(g,{key:1,id:"noTasksRunning"},{default:t(()=>[o(" No librarian tasks running ")]),_:1}))]),_:1})]),_:1},8,["onClick"])],64)}const Q=h(U,[["render",K],["__scopeId","data-v-89ffc8fa"]]);const X={name:"AdminMenu",components:{AdminStatusList:Q},props:{menu:{type:Boolean,default:!0}},data(){return{mdiBookAlert:w,mdiOpenInNew:F,mdiDatabaseClockOutline:M,mdiCogOutline:N}},computed:{...j(x,["isUserAdmin"]),...z(_,{unseenFailedImports:e=>e.unseenFailedImports})},methods:{...k(_,["clearFailedImports","librarianTask"])}},Y={key:0},Z={key:0};function ee(e,r,i,v,u,l){const n=D("AdminStatusList");return e.isUserAdmin?(s(),c("div",Y,[i.menu?(s(),c("div",Z,[a(S,{onClick:r[0]||(r[0]=A=>e.librarianTask("poll"))},{default:t(()=>[a(g,null,{default:t(()=>[a(f,null,{default:t(()=>[o(d(u.mdiDatabaseClockOutline),1)]),_:1}),o("Poll All Libraries")]),_:1})]),_:1}),a(S,{to:{name:"admin"},onClick:r[1]||(r[1]=A=>e.unseenFailedImports=!1)},{default:t(()=>[a(g,null,{default:t(()=>[a(f,null,{default:t(()=>[o(d(u.mdiCogOutline),1)]),_:1}),o("Admin Panel "),e.unseenFailedImports?(s(),p(f,{key:0,id:"failedImportsIcon",title:"New Failed Imports"},{default:t(()=>[o(d(u.mdiBookAlert),1)]),_:1})):m("",!0)]),_:1})]),_:1})])):m("",!0),a(n)])):m("",!0)}const te=h(X,[["render",ee],["__scopeId","data-v-5a4646ff"]]),ie=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"}));const ae={name:"AdminSettingsButtonProgress",computed:{...I(_,["librarianStatuses"]),progressEnabled:function(){return this.librarianStatuses.length>0},progress:function(){let e=0,r=0;if(!(!this.librarianStatuses||this.librarianStatuses.length===0)){for(const i of this.librarianStatuses){if(i.total===null||i.total===void 0||i.complete===void 0)return;e+=+i.complete,r+=+i.total}if(!(r<=0))return 100*e/r}}},created(){this.loadTable("LibrarianStatus")},methods:{...k(_,["loadTable"])}};function ne(e,r,i,v,u,l){return l.progressEnabled?(s(),p(E,{key:0,indeterminate:l.progress==null,"model-value":l.progress,class:"progress",size:"36","aria-label":"`Librarian tasks in progress ${Math.round(progress)}%`"},null,8,["indeterminate","model-value"])):m("",!0)}const se=h(ae,[["render",ne],["__scopeId","data-v-8db54809"]]),le=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"}));export{ie as a,le as b};
